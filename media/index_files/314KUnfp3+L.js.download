(function(e){var f=window.AmazonUIPageJS||window.P,l=f._namespace||f.attributeErrors,g=l?l("AllOffersDisplayIngressAssets",""):f;g.guardFatal?g.guardFatal(e)(g,window):g.execute(function(){e(g,window)})})(function(e,f,l){e.execute("all-offers-display-ingress-init",function(){var g=f.uex;"function"===typeof uet&&uet("bb","aod-ingress-assets-load-time",{wb:1});e.when("A","jQuery","all_offers_display_ingress_utils","all-offers-display-register-state","all_offers_display_ingress_csm_counters").execute("all_offers_display_ingress_load_AOD_assets",
function(b,a,c,h,d){function k(c){e.now().execute(function(a){a!==l||h.isMarkerOverrideRegistered()||("function"===typeof n&&n("bb","aod-main-assets-injection",{wb:1}),e.register("aodIngressClick"),e.register("aodDeclarativeEvent",function(){return c}),h.setMarkerOverrideTriggered())})}var n=f.uet;b.state("aod:assetsLoaded",{isAodAssetsLoaded:!0});d.triggerUnitCounter("aodIngressAssetsLoadCtr");b.declarative("show-all-offers-display","click",function(a){a.$event.preventDefault();a.$event.stopPropagation();
a&&a.data&&a.data.ingressName&&d.incrementAndTriggerCounter(a.data.ingressName+"LoadAod");a&&a.data&&a.data.daodiDesktopExp2Treatment&&d.incrementAndTriggerCounter("daodiDesktopExp2MetricTreatment"+a.data.daodiDesktopExp2Treatment);!b.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(a)&&(k(a),e.when("aod-load-event-handler","aodDeclarativeEvent").execute(function(a,c){c&&c.data&&(c.data.pc="dp");a.renderAodAction(c)}))});b.declarative("s-show-all-offers-display","click",function(a){a.$event.preventDefault();
a.$event.stopPropagation();!b.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(a)&&(k(a),e.when("search-all-offers-display-util","aodDeclarativeEvent").execute(function(a,c){a.searchOnClickHandler(c)}))});b.declarative("all-offers-display-show-from-morpheus","click",function(a){a.$event.preventDefault();a.$event.stopPropagation();!b.state("aod:assets2Loaded")&&c.isClickOnAODIngressSupported(a)&&(k(a),e.when("all-offers-display-morpheus-util","aodDeclarativeEvent").execute(function(a,c){a.openAODFromMorpheus(c)}))})});
e.when("A","jQuery","all-offers-display-register-state","all_offers_display_ingress_csm_counters").execute("all-offers-display-enable-compare",function(b,a,c,h){var d=f.uet;b.state("aod:assets2Loaded")||(b=f.location.href.split("?"),1<b.length&&(b=b[1].toLowerCase().split(/[&,#]/))&&-1!==b.indexOf("aod\x3d1")&&e.now().execute(function(a){a===l&&(c.isMarkerOverrideRegistered()?h.incrementAndTriggerCounter("aodAutoLoadMarkerOverrideSetCtr"):(h.triggerUnitCounter("aodAutoLoadAssetsRequestedCtr"),"function"===
typeof d&&d("bb","aod-main-assets-injection-auto-load",{wb:1}),e.register("aodIngressClick"),c.setMarkerOverrideTriggered()))}))});e.when("A","jQuery","all_offers_display_ingress_olp_hyperlink").register("all_offers_display_ingress_utils",function(b,a,c){return{isClickOnAODIngressSupported:function(a){return c.getOlpHyperlink(a)?!0:!1}}});e.register("all_offers_display_ingress_csm_counters",function(){var b=f.ue;return{incrementAndTriggerCounter:function(a){b&&b.count&&b.count(a,(b.count(a)||0)+1)},
triggerUnitCounter:function(a){b&&b.count&&b.count(a,1)}}});e.when("all_offers_display_ingress_csm_counters").register("all_offers_display_ingress_aod_supported",function(b){return{isPropertySupported:function(a,c,h){var d=typeof a[c]===h;if(!d){var k={};a.tagName&&(k.tagName=a.tagName);a.getAttribute&&"function"===typeof a.getAttribute&&(a.getAttribute("id")&&(k.id=a.getAttribute("id")),a.getAttribute("class")&&(k.class=a.getAttribute("class")),a.getAttribute("href")&&(k.href=a.getAttribute("href")));
a="aodPropertyUnsupportedMessage, element: "+JSON.stringify(k);e.log(a+(", propertyName: "+c+", propertyType: "+h),"WARN","aodPropertyUnsupportedMessage");b.triggerUnitCounter("aodPropertyUnsupportedMessage")}return d}}});e.when("A","jQuery","all_offers_display_ingress_aod_supported").register("all_offers_display_ingress_olp_hyperlink",function(b,a,c){return{getOlpHyperlink:function(b){if(b&&b.$event&&b.$event.target){var d=b.$event.target;if("A"===d.nodeName&&d.href)return d.href;if(c.isPropertySupported(b.$event.target,
"closest","function"))return(b=d.closest("a"))?b.href:null;if(b=a(d).closest("a"))return b.attr("href")}return null}}});e.when("A","jQuery").register("all-offers-display-register-state",function(b,a){var c=!1;return{isMarkerOverrideRegistered:function(){return c},setMarkerOverrideTriggered:function(){c=!0}}});"use strict";e.when("A","mbc_constants","all_offers_display_ingress_csm_counters").register("mbc_atc_cart_api_ajax_controller",function(b,a,c){var h=l,d;return{mbcAtcAjaxCall:function(d){h?c.incrementAndTriggerCounter(a.MBC_ATC_CLICK_CANCELLED_CSM_METRIC):
h=b.$.ajax({url:d.url,type:d.type,data:d.data,cache:!1,headers:d.headers,xhrFields:d.xhrFields,success:d.successHandler,error:d.errorHandler,timeout:d.timeout||1E4})},updateCartCount:function(b){e.when("EWC").execute(function(a){d=a});d!==l&&"function"===typeof d.refresh?(d.refresh(),c.triggerUnitCounter(a.MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME)):(e.when("nav.setCartCount").execute(function(a){a(b)}),c.triggerUnitCounter(a.MBC_NAV_API_CSM_METRIC_SCOPE_NAME))},resetAjaxHandler:function(){h=l}}});
"use strict";e.when("A","mbc_constants","mbc_cart_api_handler").execute("mbc_atc_action_handler",function(b,a,c){b.declarative("mbc-atc-action",a.MBC_WIDGET_TRIGGER_EVENTS,function(a){c.addToCart(a.data,!0)})});"use strict";e.when("A","jQuery","mbc_constants","all_offers_display_ingress_csm_counters","mbc_atc_cart_api_ajax_controller").register("mbc_cart_api_handler",function(b,a,c,e,d){function k(b){e.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME);var d=b.offerIndex;a(c.MBC_OFFER_ADDED_TO_CART+
d).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME);a(c.MBC_OFFER_NOT_ADDED_TO_CART+d).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME);f(b.offerIndex)}function f(b){a(c.MBC_OFFER_VIEW_CART_BUTTON+b).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME);a(c.MBC_OFFER_ATC_BUTTON_ID+b).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME)}return{addToCart:function(b,l){var g=a(c.MBC_ATC_AJAX_ENDPOINT).val(),p=a(c.MBC_ATC_CSRF_TOKEN).val(),q=a(c.MBC_LANGUAGE_HEADER).val(),g={url:"https://"+g+"?ref\x3d"+b.refTag+"\x26sr\x3d"+b.sr+"\x26qid\x3d"+b.qid,
type:"POST",data:JSON.stringify({items:[{asin:b.asin,offerListingId:b.oid,quantity:b.minQty}]}),headers:{"Accept-Language":q,Accept:c.MBC_ATC_CART_API_HEADER_ACCEPT,"x-api-csrf-token":p,"Content-Type":c.MBC_ATC_CART_API_HEADER_CONTENT_TYPE},xhrFields:{withCredentials:!0},timeout:1E4,successHandler:function(m){m&&m.entity&&m.entity.items&&m.entity.items[0]&&0<m.entity.items[0].quantity?(m.entity.count&&m.entity.count.entity&&m.entity.count.entity.items?d.updateCartCount(m.entity.count.entity.items):
(e.triggerUnitCounter(c.MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC),d.updateCartCount(m.entity.items[0].quantity)),e.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME),l&&a(c.MBC_OFFER_ADDED_TO_CART+b.offerIndex).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME),f(b.offerIndex)):k(b);d.resetAjaxHandler()},errorHandler:function(a){422===a.status&&(a=JSON.parse(a.responseText))&&a.entity&&a.entity.items&&a.entity.items[0]&&(a.entity.count&&a.entity.count.entity&&a.entity.count.entity.items?
d.updateCartCount(a.entity.count.entity.items):(e.triggerUnitCounter(c.MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC),d.updateCartCount(a.entity.items[0].quantity)));k(b);d.resetAjaxHandler()}};d.mbcAtcAjaxCall(g)}}});e.register("mbc_constants",function(){return{MBC_ATC_AJAX_ENDPOINT:"#mbc-atc-ajax-endpoint",MBC_ATC_CSRF_TOKEN:"#mbc-atc-csrf-token",MBC_LANGUAGE_HEADER:"#mbc-language",MBC_OFFER_ADDED_TO_CART:"#mbc-offer-added-to-cart-",MBC_OFFER_NOT_ADDED_TO_CART:"#mbc-offer-not-added-to-cart-",MBC_OFFER_VIEW_CART_BUTTON:"#mbc-offer-view-cart-",
MBC_OFFER_ATC_BUTTON_ID:"#mbc-buybutton-addtocart-",MBC_ATC_CLICK_CANCELLED_CSM_METRIC:"mbc-atc-click-cancelled",MBC_ATC_CART_API_HEADER_ACCEPT:'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',MBC_ATC_CART_API_HEADER_CONTENT_TYPE:'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',MBC_NAV_API_CSM_METRIC_SCOPE_NAME:"mbc-nav-api-called",MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME:"mbc-ewc-refresh-api-called",MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC:"mbc-cart-api-success-response-count-failure",
MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC:"mbc-cart-api-error-response-count-failure",MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME:"mbc-cart-api-atc-success",MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME:"mbc-cart-api-atc-failure",MBC_WIDGET_TRIGGER_EVENTS:"click",AUI_HIDE_ELEMENT_CSS_NAME:"aok-hidden"}});"function"===typeof g&&g("ld","aod-ingress-assets-load-time",{wb:1})})});